<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <title>Hobby Store</title>
        <style>
          .navbar-custom {
              background-color: #343a40; 
          }
          .navbar-custom .navbar-brand {
              color: #ffffff; 
          }
          .navbar-custom .nav-link {
              color: #ffffff;
          }
          .navbar-custom .nav-link:hover {
              color: #cccccc; 
          }
          body {
            background-color: #dc3545; 
        }
      </style>
    </head>
<body>
    <nav class="navbar navbar-expand-sm bg-dark navbar-dark">
        <div class="container-fluid">
          <a class="navbar-brand" href="/">Hafiz Hobby Store</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#collapsibleNavbar">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="collapsibleNavbar">
            <ul class="navbar-nav">
              <li class="nav-item">
                <a class="nav-link" href="/addProduct">Add new product</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/cart">Cart</a>
            </li>
            </ul>
          </div>
        </div>
    </nav>

  <div class="container">
    <br>
    <div class="text-center"><h2>Hobby Shop</h2></div>
    <br>
  
    <table class="table table-hover small text-center" >
      <thead>
          <tr>
            <th width="100">Product Name</th>
            <th width="50">Price</th>
            <th width="50">Product Image</th>
            <th width="100">Description</th>
            <th width="50">Quantity</th>
            <th width="50">Edit</th>
            <th width="50">Delete</th>
            <th width="50">Add to Cart</th>
          </tr>
      </thead>
      <tbody>
        <% products.forEach(products => { %>
        <tr>
            <td><a href="/product/ <%= products.productId %>" ><%= products.name %></a></td>
            <td>$<%= products.price %></td>
            <td><img src="/images/<%= products.image %>" alt="<%= products.name %>" width="50"></td>
            <td><%= products.description %></td>
            <td><%= products.quantity %></td>
            <td><a href="/editProduct/<%= products.productId %>" class="btn btn-warning">Edit</a></td>
            <td><a href="/deleteProduct/<%= products.productId %>" class="btn btn-danger">Delete</a></td>
            <td><button class="btn btn-primary" onclick="addToCart(<%= products.productId %>, '<%= products.name %>', <%= products.price %>)">Add to Cart</button></td>
        </tr>
        <% }); %>
    </tbody>
    </table>
  </div>
  <script>
    function addToCart(productId, name, price) {
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let existingProduct = cart.find(products => products.productId === productId);

        if (existingProduct) {
            existingProduct.quantity++;
        } else {
            cart.push({ productId, name, price, quantity: 1 });
        }

        localStorage.setItem('cart', JSON.stringify(cart));
        alert('Product added to cart!');
    }
    </script>
</body>
</html>